/*! This is uglify test - 2019-09-15 */
var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define(["require","exports","./request","jquery","./md","./action","./style","./config"],function(e,t,i,o,n,r,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=__importDefault(o),l=__importDefault(l);function a(e,t){void 0===e&&(e=""),void 0===t&&(t=3);var a={url:"http://static.codeinfo.top/qiniu/index/index",data:{host:l.default.qiniu.host,bucket:l.default.qiniu.bucket,type:l.default.qiniu.list.type,prefix:"image",marker:e,limit:t},method:"GET"};i.req.text(a,function(e){var t=JSON.parse(e);if(2001==t.code){for(var a in t.data.items)p.push(t.data.items[a]);!function(e){var t="";for(var a in o.default(".images-list").empty(),p)t+='<li title="点击复制" data-clipboard-text="//'+p[a].key+'"><img src="//'+p[a].key+'"></li>';e&&(t+='<b class="loading" data-qiniu-marker="'+e+'">加载更多</b>'),o.default(".images-list").append(t)}(t.data.marker)}else u.alerter(t.msg)})}var d=document.querySelector("#form-content"),f=document.querySelector(".effect-preview"),c=document.querySelector(".code-preview"),p=[];t.lstImg=a;function s(e,t,i,n){var r=document.querySelector(t);o.default(e).on("click",function(){o.default(t).trigger("click"),o.default(t).on("change",function(e){var t=e.target.value,a=t.substring(t.lastIndexOf("\\")+1);a?o.default(i).text(a):o.default(i).text("选择文件"),n(r.files)})}),o.default(e).on("dragover",function(e){e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}),o.default(e).on("drop",function(e){e.originalEvent.preventDefault(),e.originalEvent.stopPropagation();var t=e.originalEvent.dataTransfer.files;o.default(i).text(t[0].name),n(t)})}t.file=function(){s(".add-file","#form-files",".file-name",function(e){!function(e){var t=new FormData;t.append("files",e[0],e[0].name);var a={url:"http://localhost:8095/server/php/index.php?fun=mdfile&db=mysql",data:t};i.req.file(a,function(e){var t=JSON.parse(e);2001==t.code&&(d.value=t.data,f.innerHTML=n.md(t.data),c.value=n.md(t.data),r.delay_save("content",d))})}(e)}),s(".add-img","#img-file",".img-name",function(e){o.default(".img-upload").on("click",function(){!function(e){var t=new FormData;t.append("host",l.default.qiniu.host),t.append("bucket",l.default.qiniu.bucket),t.append("type",l.default.qiniu.upload.type),t.append("file",e[0],e[0].name);var a={url:"http://static.codeinfo.top/qiniu/index/index",data:t};i.req.file(a,function(e){var t=JSON.parse(e);u.alerter(t.msg)})}(e)})}),o.default(".images-list").on("click","b",function(e){var t=o.default(".loading").attr("data-qiniu-marker");a(t)})}});